---
author:
    -ChatGPT4o y √Ålvaro Cabana
lang: es
abstract-title: Notas
abstract: Traducido al espa√±ol rioplatense por ChatGPT4-o bajo la supervisi√≥n de √Ålvaro Cabana.
aliases: [06b-chi_cuadrado.html]
---

## Prueba de Chi cuadrado

### Las medias no son todo

En el cap√≠tulo anterior aprendimos a comparar grupos a trav√©s de sus medias. Vimos c√≥mo una diferencia entre promedios puede parecer importante, pero quiz√° no lo sea estad√≠sticamente. Aprendimos a preguntarnos si esa diferencia pod√≠a explicarse por el azar, y c√≥mo usar la estad√≠stica *t* para contestar esa pregunta.

Pero no todos los datos con los que trabajamos en psicolog√≠a se organizan en escalas num√©ricas.

Much√≠simos estudios ‚Äîen cl√≠nica, en encuestas, en educaci√≥n‚Äî recolectan datos **categ√≥ricos**: s√≠ o no, a favor o en contra, bajo o medio o alto. A veces las variables son respuestas cerradas; otras veces son grupos: mujeres y varones, pacientes con o sin diagn√≥stico, personas que aprobaron o no una intervenci√≥n.

Y entonces ya no tenemos medias. Lo que tenemos son **frecuencias**. Conteos. Tablas. Categor√≠as. ¬øPodemos hacer inferencias tambi√©n con eso?

### La respuesta es s√≠: con chi cuadrado

La l√≥gica es la misma que aprendiste con la *t*:

> **Comparar lo que vemos con lo que esperar√≠amos si no hubiera efecto.**

La diferencia es que ahora no vamos a comparar **medias**, sino **frecuencias**.

La prueba chi cuadrado nos dice si las diferencias entre los grupos que observamos ‚Äîen t√©rminos de **conteos**‚Äî son tan grandes como para que no puedan explicarse solo por el azar.

Si las diferencias son peque√±as, o parecidas a lo que el azar produce habitualmente, no hay problema: concluimos que no hay efecto.
Pero si las diferencias son muy marcadas ‚Äîsi los n√∫meros de la tabla est√°n lejos de lo que esperar√≠amos bajo la independencia‚Äî, entonces tenemos evidencia de que algo real est√° ocurriendo.

Y eso es lo que vamos a aprender en este cap√≠tulo:

> C√≥mo hacer inferencia estad√≠stica cuando lo que tenemos son categor√≠as y frecuencias, no puntajes ni promedios.

Perfecto. Continuamos entonces con una explicaci√≥n visual y narrativa de la **distribuci√≥n chi cuadrado**, que permita al lector comprender c√≥mo se interpreta el valor $\chi^2$, c√≥mo se relaciona con el valor *p*, y qu√© papel cumplen los grados de libertad. Todo manteniendo el tono del libro, y reforzando la intuici√≥n a trav√©s de gr√°ficos generados en R.


## La distribuci√≥n chi cuadrado: una curva para contar diferencias

Cuando usamos la prueba *t*, vimos que los valores extremos ‚Äîdiferencias de medias muy grandes‚Äî son poco probables si la hip√≥tesis nula es cierta.
Y que cuanto m√°s extremo era el valor de *t*, m√°s improbable, y m√°s peque√±o era el valor *p*.

Con la prueba chi cuadrado pasa lo mismo. Solo que, en vez de una distribuci√≥n sim√©trica como la *t*, ahora tenemos una distribuci√≥n **asim√©trica y positiva**: la distribuci√≥n chi cuadrado.

¬øPor qu√© solo tiene valores positivos? Porque el estad√≠stico $\chi^2$ se construye como una **suma de diferencias al cuadrado**. Y eso **nunca puede dar negativo**.

La forma de la curva cambia con los **grados de libertad**. Pero su interpretaci√≥n es siempre la misma:

> Valores de $\chi^2$ muy grandes son poco probables si la hip√≥tesis nula es cierta.
> Si tu valor observado cae en esa zona rara, entonces lo que est√°s viendo **no parece fruto del azar**.


### Visualicemos la distribuci√≥n

Vamos a graficar la distribuci√≥n chi cuadrado con los grados de libertad correspondientes a nuestro ejemplo anterior:

```{r}
#| label: dist-chi-cuadrado
#| fig-cap: "Distribuci√≥n chi cuadrado con 2 grados de libertad"

library(ggplot2)

df <- chisq_resultado$parameter  # grados de libertad
x_vals <- seq(0, 20, length.out = 300)
y_vals <- dchisq(x_vals, df = df)
chi_observado <- chisq_resultado$statistic

data_dist <- data.frame(x = x_vals, y = y_vals)

ggplot(data_dist, aes(x, y)) +
  geom_line(size = 1.2) +
  geom_vline(xintercept = chi_observado, linetype = "dashed", color = "red") +
  annotate("text", x = chi_observado + 1, y = max(y_vals)/2,
           label = paste("œá¬≤ observado =", round(chi_observado, 2)), color = "red") +
  labs(title = paste("Distribuci√≥n chi cuadrado con", df, "grados de libertad"),
       x = "Valor œá¬≤", y = "Densidad") +
  theme_minimal(base_size = 14)
```

---

### Interpretar el valor *p*

El valor *p* es **el √°rea bajo la curva a la derecha** del valor $\chi^2$ observado.
Es decir: la probabilidad de observar una diferencia **tan grande como la que vimos**, o m√°s, si la hip√≥tesis nula fuera cierta.

Cuanto m√°s grande es el valor observado, **m√°s improbable es bajo la nula**, y menor es el valor *p*.

Si el valor *p* es menor a 0.05, concluimos que la diferencia **es significativa**: que lo que vemos en la tabla no parece fruto del azar.

---

### Y si no, no

Y si el valor *p* es mayor, no pasa nada. Significa que **los datos no se alejan demasiado de lo esperado**. Que no hay suficiente evidencia para decir que las variables est√°n relacionadas.

Esto no prueba que sean independientes. Solo dice que, con esta muestra, **no podemos afirmar que no lo sean**.

---

### üß† Reforzando la intuici√≥n

Con la *t*, comparamos medias.
Con chi cuadrado, comparamos frecuencias.
En ambos casos, la l√≥gica es la misma:

> *¬øLo que veo se parece a lo que esperar√≠a por azar?*

La diferencia est√° en **qu√© se compara**, y **c√≥mo se mide la diferencia**. Pero la idea es siempre la misma.

---

¬øQuer√©s que ahora siga con una secci√≥n de **simulaci√≥n**, mostrando c√≥mo se comporta el test chi cuadrado bajo la hip√≥tesis nula, usando datos generados al azar?


